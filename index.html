<!doctype html>
<html lang="fa">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø¨Ø§Ø²ÛŒ Ø§Ù„ÙØ¨Ø§ â€” ØªØ³Øª (Ø¨)</title>
<style>
  :root{--bg:#fff8ec;--card:#fff;--accent:#ff7a59;--accent2:#4CAF50;--muted:#777;}
  body{font-family:Tahoma,Vazir,sans-serif;direction:rtl;text-align:center;margin:0;padding:18px;background:var(--bg);color:#222}
  .wrap{max-width:760px;margin:0 auto}
  .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
  header{font-size:20px;margin-bottom:8px}
  #bigChar{font-size:120px;margin:8px 0;font-weight:700}
  .controls{margin:10px 0}
  button{font-size:18px;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;background:var(--accent2);color:white;margin:6px}
  .muted{background:#eee;color:#333}
  .small{font-size:14px;color:var(--muted);margin-top:8px}
  .hidden{display:none}
  .vowelRow{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:12px}
  .vbox{width:100px;height:72px;border-radius:10px;border:2px solid #eee;display:flex;align-items:center;justify-content:center;font-size:30px;background:#fff}
  .vbox.active{border-color:#2196f3;box-shadow:0 4px 10px rgba(33,150,243,0.08)}
  .choices{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:12px}
  .choice{background:#fff;border:2px solid #ddd;padding:12px;border-radius:12px;min-width:100px;font-size:30px;cursor:pointer;display:flex;align-items:center;justify-content:center}
  .choice.correct{background:#c8e6c9;border-color:#2e7d32}
  .choice.wrong{background:#ffcdd2;border-color:#c62828}
  #score{color:#f39c12;font-size:20px;margin-top:8px;min-height:22px}
  footer{margin-top:12px;font-size:13px;color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>Ø¨Ø§Ø²ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ â€” ØªÙ„ÙØ¸ Ùˆ Ø´Ù†Ø§Ø®Øª Ú©Ù„Ù…Ù‡ (Ù†Ø³Ø®Ù‡Ù” ØªØ³Øª)</header>

      <div id="stageTitle">Ù…Ø±Ø­Ù„Ù‡ Û±: Ø­Ø±Ù</div>
      <div id="bigChar">Ø¨</div>

      <div class="controls" id="stage1Controls">
        <button id="playLetter">ğŸ”Š Ù¾Ø®Ø´ Ø­Ø±Ù</button>
        <button id="listenLetter">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù† (ØªÙ„ÙØ¸ Ú©Ù†)</button>
        <button id="nextToVowels" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” Ø­Ø±Ú©Ø§Øª</button>
      </div>
      <div id="message" class="small"></div>

      <div id="vowelsArea" class="hidden">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û²: Ø­Ø±Ú©Ø§Øª</h3>
        <div class="vowelRow">
          <div class="vbox" data-syll="Ø¨Ø§">Ø¨Ø§</div>
          <div class="vbox" data-syll="Ø¨Ùˆ">Ø¨Ùˆ</div>
          <div class="vbox" data-syll="Ø¨ÛŒ">Ø¨ÛŒ</div>
        </div>
        <div style="margin-top:10px">
          <button id="playSyll" class="muted">ğŸ”Š Ù¾Ø®Ø´ ÙØ¹Ù„ÛŒ</button>
          <button id="listenSyll">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù†</button>
        </div>
        <div id="subMessage" class="small"></div>
        <div style="margin-top:8px">
          <button id="toWord" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” Ú©Ù„Ù…Ù‡</button>
        </div>
      </div>

      <div id="wordArea" class="hidden" style="margin-top:12px">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û³: Ú©Ù„Ù…Ù‡</h3>
        <div id="wordBig" style="font-size:48px;font-weight:700">Ø¨Ø§Ø¨Ø§</div>
        <div style="margin-top:8px">
          <button id="playWord">ğŸ”Š Ù¾Ø®Ø´ Ú©Ù„Ù…Ù‡</button>
          <button id="listenWord">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù†</button>
        </div>
        <div id="wordMsg" class="small"></div>
        <div style="margin-top:8px">
          <button id="toChoose" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” ØªØ´Ø®ÛŒØµ</button>
        </div>
      </div>

      <div id="chooseArea" class="hidden" style="margin-top:12px">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û´: Ø´Ù†ÛŒØ¯Ø§Ø±ÛŒ + ØªØµÙˆÛŒØ±ÛŒ</h3>
        <div style="margin-bottom:8px">
          <button id="playTarget" class="muted">ğŸ”Š Ù¾Ø®Ø´ Ú©Ù„Ù…Ù‡ Ù‡Ø¯Ù</button>
        </div>
        <div class="choices">
          <div class="choice" data-word="Ø¨Ø§Ø¨Ø§">ğŸ‘¨</div>
          <div class="choice" data-word="Ø³ÛŒØ¨">ğŸ</div>
          <div class="choice" data-word="ØªÙˆÙ¾">âš½</div>
        </div>
        <div id="chooseMsg" class="small"></div>
      </div>

      <div id="score"></div>
      <div class="small">Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ØªØ±ÛŒÙ† Ù†ØªÛŒØ¬Ù‡: Ø§Ø² Chrome Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù† Ùˆ ÙˆÙ‚ØªÛŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø¯Ø§Ø¯ØŒ Allow Ø±Ø§ Ø¨Ø²Ù†.</div>
    </div>

    <footer>Ù†Ø³Ø®Ù‡Ù” ØªØ³Øª â€” Ù‡Ø± Ù…Ø´Ú©Ù„ Ú¯Ø²Ø§Ø±Ø´ Ú©Ù† ØªØ§ Ø§ØµÙ„Ø§Ø­ Ú©Ù†Ù….</footer>
  </div>

  <!-- ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ (Ù…Ø´Ø®Øµ Ø´Ø¯Ù‡ Ø¨Ø§ Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ø±Ø¯ÛŒ) -->
  <audio id="a_letter" src="b.m4a"></audio>
  <audio id="a_ba" src="ba.m4a"></audio>
  <audio id="a_baba" src="baba.m4a"></audio>

<script>
/* ======= Ø¯Ø§Ø¯Ù‡ Ùˆ Ø­Ø§Ù„Øª ======= */
const lesson = {
  letter: "Ø¨",
  syllables: ["Ø¨Ø§","Ø¨Ùˆ","Ø¨ÛŒ"],
  word: "Ø¨Ø§Ø¨Ø§",
  choices: ["Ø¨Ø§Ø¨Ø§","Ø³ÛŒØ¨","ØªÙˆÙ¾"]
};

let score = 0;
let currentSyllIndex = 0;

/* ======= Ø§Ù„Ù…Ù†Øªâ€ŒÙ‡Ø§ ======= */
const playLetter = document.getElementById('playLetter');
const listenLetter = document.getElementById('listenLetter');
const nextToVowels = document.getElementById('nextToVowels');
const message = document.getElementById('message');

const vowelsArea = document.getElementById('vowelsArea');
const vboxes = document.querySelectorAll('.vbox');
const playSyll = document.getElementById('playSyll');
const listenSyll = document.getElementById('listenSyll');
const subMessage = document.getElementById('subMessage');
const toWord = document.getElementById('toWord');

const wordArea = document.getElementById('wordArea');
const playWord = document.getElementById('playWord');
const listenWord = document.getElementById('listenWord');
const wordMsg = document.getElementById('wordMsg');
const toChoose = document.getElementById('toChoose');

const chooseArea = document.getElementById('chooseArea');
const playTarget = document.getElementById('playTarget');
const choices = document.querySelectorAll('.choice');
const chooseMsg = document.getElementById('chooseMsg');

const scoreEl = document.getElementById('score');

/* ======= audio elements ======= */
const audioLetter = document.getElementById('a_letter');
const audioBa = document.getElementById('a_ba');
const audioBaba = document.getElementById('a_baba');

/* ======= Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù…ØªÙ† ======= */
function normalizePersian(s){
  if(!s) return "";
  s = s + "";
  s = s.toLowerCase().trim();
  s = s.replace(/[\u064B-\u0652]/g,"");
  s = s.replace(/[ÙŠ]/g,"ÛŒ").replace(/[Ùƒ]/g,"Ú©");
  s = s.replace(/Ø¢/g,"Ø§");
  s = s.replace(/\s+/g,"");
  return s;
}

/* ======= Ù¾Ø®Ø´ Ø§Ù…Ù† ØµÙˆØª (Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² interaction) ======= */
function safePlay(audioEl){
  // audioEl must be played after user interaction
  audioEl.currentTime = 0;
  const p = audioEl.play();
  if(p && p.catch){
    p.catch(err => {
      console.log('audio play error', err);
    });
  }
}

/* ======= Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† (Ø¨Ø§Ø¹Ø« Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù† Ù¾Ø±Ù…ÛŒØ´Ù† Ù…ÛŒâ€ŒØ´ÙˆØ¯) ======= */
async function ensureMic(){
  if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) return;
  try{
    await navigator.mediaDevices.getUserMedia({ audio: true });
  }catch(e){
    console.log('mic permission denied or error', e);
  }
}

/* ======= SpeechRecognition helper (promise) ======= */
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition || null;
function isRecognitionAvailable(){ return !!SpeechRecognition; }

function listenOnce(lang='fa-IR', timeout=7000){
  return new Promise((resolve,reject)=>{
    if(!SpeechRecognition){
      reject('noapi');
      return;
    }
    const r = new SpeechRecognition();
    r.lang = lang;
    r.interimResults = false;
    r.maxAlternatives = 3;
    let done = false;
    try{ r.start(); } catch(e){ reject(e); return; }
    r.onresult = (ev)=>{
      done = true;
      const txt = ev.results[0][0].transcript;
      resolve(txt);
    };
    r.onerror = (ev)=>{
      if(!done) reject(ev.error || ev.message || 'error');
    };
    setTimeout(()=>{ try{ r.stop(); }catch(e){} }, timeout);
  });
}

/* ======= Ù…Ø±Ø­Ù„Ù‡ 1: Ø­Ø±Ù ======= */
playLetter.addEventListener('click', ()=> {
  // ensure user interaction
  safePlay(audioLetter);
});
listenLetter.addEventListener('click', async ()=>{
  message.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ Ø­Ø±Ù Ø±Ø§ Ø¨Ú¯Ùˆ.";
  if(!isRecognitionAvailable()){
    message.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    return;
  }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    message.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(lesson.letter);
    if(got === target || got.includes(target)){
      message.textContent = "Ø¢ÙØ±ÛŒÙ†! ØªÙ„ÙØ¸ Ø­Ø±Ù Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ ğŸ‰";
      score++; updateScore();
      nextToVowels.classList.remove('muted');
      nextToVowels.disabled = false;
      setTimeout(()=> showVowels(), 900);
    } else {
      message.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ Ø¯Ú©Ù…Ù‡ Ù¾Ø®Ø´ Ø±Ø§ ÙØ´Ø§Ø± Ø¨Ø¯Ù‡.";
    }
  }catch(err){
    if(err === 'noapi') message.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else message.textContent = "Ø®Ø·Ø§ Ø¯Ø± ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±: " + (err.message || err);
  }
});
nextToVowels.addEventListener('click', showVowels);

/* ======= Ù…Ø±Ø­Ù„Ù‡ 2: Ø­Ø±Ú©Ø§Øª ======= */
function showVowels(){
  vowelsArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û²: Ø­Ø±Ú©Ø§Øª (Ø¨Ø§ØŒ Ø¨ÙˆØŒ Ø¨ÛŒ)";
  currentSyllIndex = 0;
  highlightVbox(currentSyllIndex);
  // Ù¾Ø®Ø´ Ø§ÙˆÙ„ÛŒÙ† Ø­Ø±Ú©Øª Ø¨Ø§ ØªØ¹Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ø²Ù… Ø§Ø³ØªØ› Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù† ØªØ§ Ú©Ø§Ø±Ø¨Ø± Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ play Ú©Ù„ÛŒÚ© Ú©Ù†Ø¯ ÛŒØ§ Ø®ÙˆØ¯Øª ØµØ¯Ø§ Ø±Ø§ Ù¾Ø®Ø´ Ú©Ù† (Ø§Ú¯Ø± interaction Ø¯Ø§Ø±ÛŒÙ…)
  safePlay(audioBa); // try play (works if user ØªØ¹Ø§Ù…Ù„ Ù‚Ø¨Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡)
}
function highlightVbox(idx){
  vboxes.forEach((b,i)=> {
    b.classList.toggle('active', i === idx);
  });
}
vboxes.forEach((box, idx)=>{
  box.addEventListener('click', ()=> {
    currentSyllIndex = idx;
    highlightVbox(idx);
    // Ù¾Ø®Ø´ ØµÙˆØª Ù…Ø±ØªØ¨Ø·
    if(idx === 0) safePlay(audioBa);
    else if(idx === 1) {/* Ø¨Ùˆ */ safePlay(audioBa); } // placeholder: currently same audio; can replace with real 'bo' file if added
    else if(idx === 2) {/* Ø¨ÛŒ */ safePlay(audioBa); } // placeholder
    subMessage.textContent = "";
  });
});
playSyll.addEventListener('click', ()=>{
  // play current
  if(currentSyllIndex === 0) safePlay(audioBa);
  else safePlay(audioBa);
});
listenSyll.addEventListener('click', async ()=>{
  subMessage.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ ØªÚ©Ø±Ø§Ø± Ú©Ù†.";
  if(!isRecognitionAvailable()){ subMessage.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯."; return; }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    subMessage.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(lesson.syllables[currentSyllIndex]);
    if(got === target || got.includes(target)){
      subMessage.textContent = "Ø¢ÙØ±ÛŒÙ†! Ø¯Ø±Ø³Øª Ú¯ÙØªÛŒ ğŸ‰";
      score++; updateScore();
      // Ø¨Ù‡ Ø­Ø±Ú©Øª Ø¨Ø¹Ø¯ÛŒ Ø¨Ø±Ùˆ
      if(currentSyllIndex < lesson.syllables.length - 1){
        currentSyllIndex++;
        highlightVbox(currentSyllIndex);
        // play next (try)
        setTimeout(()=> safePlay(audioBa), 700);
      } else {
        setTimeout(()=> showWord(), 900);
      }
    } else {
      subMessage.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ ØµØ¯Ø§ Ø±Ø§ Ú¯ÙˆØ´ Ú©Ù†.";
    }
  }catch(err){
    if(err === 'noapi') subMessage.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else subMessage.textContent = "Ø®Ø·Ø§ Ø¯Ø± ØªØ´Ø®ÛŒØµ Ø³Ø®Ù†: " + (err.message || err);
  }
});
toWord.addEventListener('click', showWord);

/* ======= Ù…Ø±Ø­Ù„Ù‡ 3: Ú©Ù„Ù…Ù‡ ======= */
function showWord(){
  wordArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û³: Ú©Ù„Ù…Ù‡";
  // play word
  safePlay(audioBaba);
}
playWord.addEventListener('click', ()=> safePlay(audioBaba));
listenWord.addEventListener('click', async ()=>{
  wordMsg.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ Ú©Ù„Ù…Ù‡ Ø±Ø§ Ø¨Ú¯Ùˆ.";
  if(!isRecognitionAvailable()){ wordMsg.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯."; return; }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    wordMsg.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(lesson.word);
    if(got === target || got.includes(target)){
      wordMsg.textContent = "Ø¢ÙØ±ÛŒÙ†! ØªÙ„ÙØ¸ Ú©Ù„Ù…Ù‡ Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ ğŸ‰";
      score++; updateScore();
      setTimeout(()=> showChoose(), 900);
    } else {
      wordMsg.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ ØµØ¯Ø§ Ø±Ø§ Ú¯ÙˆØ´ Ú©Ù†.";
    }
  }catch(err){
    if(err === 'noapi') wordMsg.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else wordMsg.textContent = "Ø®Ø·Ø§: " + (err.message || err);
  }
});
toChoose.addEventListener('click', showChoose);

/* ======= Ù…Ø±Ø­Ù„Ù‡ 4: Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ±ÛŒ ======= */
function showChoose(){
  chooseArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û´: Ø´Ù†ÛŒØ¯Ø§Ø±ÛŒ + ØªØµÙˆÛŒØ±ÛŒ (Ù„Ù…Ø³ ØªØµÙˆÛŒØ± Ø¯Ø±Ø³Øª)";
  // play target
  safePlay(audioBaba);
}
playTarget.addEventListener('click', ()=> safePlay(audioBaba));
choices.forEach(ch=>{
  ch.addEventListener('click', ()=>{
    const pick = ch.dataset.word;
    if(normalizePersian(pick) === normalizePersian(lesson.word)){
      ch.classList.add('correct');
      chooseMsg.textContent = "Ø¢ÙØ±ÛŒÙ†! Ø¯Ø±Ø³Øª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯ÛŒ ğŸ‰";
      score++; updateScore();
      setTimeout(()=> { chooseMsg.textContent = "ØªØ¨Ø±ÛŒÚ©! Ø§ÛŒÙ† Ø¯Ø±Ø³ ØªÙ…Ø§Ù… Ø´Ø¯."; },700);
    } else {
      ch.classList.add('wrong');
      chooseMsg.textContent = "Ù†Ù‡Ø› Ø§Ø´ØªØ¨Ø§Ù‡Ù‡. Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.";
      setTimeout(()=> { ch.classList.remove('wrong'); chooseMsg.textContent=''; },900);
    }
  });
});

/* ======= helper ======= */
function updateScore(){ scoreEl.textContent = "â­".repeat(score); }

/* ======= Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø§Ú¯Ø± SpeechRecognition Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†Ø¨ÙˆØ¯ ======= */
if(!isRecognitionAvailable()){
  const warn = document.createElement('div');
  warn.className = 'small';
  warn.style.color = 'crimson';
  warn.style.marginTop = '8px';
  warn.textContent = 'ØªØ°Ú©Ø±: Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯Ø› Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª ÙÙ‚Ø· Ù¾Ø®Ø´ ØµÙˆØª ÙØ¹Ø§Ù„ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.';
  document.querySelector('.card').appendChild(warn);
}

/* ======= ØªÙ„Ø§Ø´ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† (Ù‡Ø± Ø²Ù…Ø§Ù† Ú©Ø§Ø±Ø¨Ø± Ú©Ù„ÛŒÚ© Ú©Ù†Ø¯ Ø¨Ù‡ØªØ±) ======= */
(async ()=>{ try{ await ensureMic(); }catch(e){} })();

</script>
</body>
</html>