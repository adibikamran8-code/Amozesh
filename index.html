<!doctype html>
<html lang="fa">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø¨Ø§Ø²ÛŒ Ø§Ù„ÙØ¨Ø§ â€” ØªØ³Øª</title>
<style>
  :root{
    --bg:#fff8ec; --card:#ffffff; --accent:#ff7a59; --accent2:#4CAF50;
    --muted:#888;
  }
  body{font-family: Tahoma, 'Vazir', sans-serif; direction:rtl; text-align:center; margin:0; padding:20px; background:var(--bg); color:#222;}
  .wrap{max-width:720px;margin:0 auto;}
  header{font-size:20px;margin-bottom:12px}
  .card{background:var(--card); border-radius:14px; padding:18px; box-shadow:0 6px 18px rgba(0,0,0,0.08);}
  #bigChar{font-size:120px; margin:10px 0; font-weight:700;}
  .controls{margin:10px 0;}
  button{font-size:18px;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;background:var(--accent2);color:white;margin:6px;}
  .muted{background:#ddd;color:#333;}
  .small{font-size:14px;color:var(--muted); margin-top:8px;}
  #message, #subMessage{min-height:24px;margin-top:10px;font-size:18px;}
  .hidden{display:none;}
  .vowelRow{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:10px;}
  .vowelBtn{background:#fff;border:2px solid #eee;padding:10px 14px;border-radius:10px;font-size:28px;min-width:86px;cursor:pointer;}
  .correct{background:#c8e6c9;border-color:#2e7d32;}
  .wrong{background:#ffcdd2;border-color:#c62828;}
  .choices{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:12px;}
  .choice{background:white;border:2px solid #ddd;padding:12px;border-radius:12px;min-width:120px;font-size:20px;cursor:pointer;}
  .star{color:#f39c12;font-size:20px;margin-top:6px;}
  footer{margin-top:12px;font-size:13px;color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>Ø¨Ø§Ø²ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ â€” ØªÙ„ÙØ¸ Ùˆ Ø´Ù†Ø§Ø®Øª Ú©Ù„Ù…Ù‡ (Ù†Ø³Ø®Ù‡ ØªØ³Øª)</header>

      <div id="stageTitle">Ù…Ø±Ø­Ù„Ù‡ Û±: Ø­Ø±Ù</div>

      <div id="bigChar">Ø¨</div>

      <div class="controls" id="stage1Controls">
        <button id="playLetter">ğŸ”Š Ù¾Ø®Ø´ Ø­Ø±Ù</button>
        <button id="listenLetter">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù† (ØªÙ„ÙØ¸ Ú©Ù†)</button>
        <button id="nextToVowels" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” Ø­Ø±Ú©Ø§Øª</button>
      </div>
      <div id="message"></div>

      <div id="vowelsArea" class="hidden">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û²: Ø­Ø±Ú©Ø§Øª</h3>
        <div class="vowelRow">
          <button class="vowelBtn" data-syll="Ø¨Ø§">Ø¨Ø§</button>
          <button class="vowelBtn" data-syll="Ø¨Ùˆ">Ø¨Ùˆ</button>
          <button class="vowelBtn" data-syll="Ø¨ÛŒ">Ø¨ÛŒ</button>
        </div>
        <div style="margin-top:10px;">
          <button id="playSyll" class="muted">ğŸ”Š Ù¾Ø®Ø´ ÙØ¹Ù„ÛŒ</button>
          <button id="listenSyll">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù†</button>
        </div>
        <div id="subMessage" class="small"></div>
        <div style="margin-top:8px;">
          <button id="toWord" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” Ú©Ù„Ù…Ù‡</button>
        </div>
      </div>

      <div id="wordArea" class="hidden" style="margin-top:12px;">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û³: Ú©Ù„Ù…Ù‡</h3>
        <div id="wordBig" style="font-size:48px;font-weight:700">Ø¨Ø§Ø¨Ø§</div>
        <div style="margin-top:8px;">
          <button id="playWord">ğŸ”Š Ù¾Ø®Ø´ Ú©Ù„Ù…Ù‡</button>
          <button id="listenWord">ğŸ¤ Ú¯ÙˆØ´ Ú©Ù†</button>
        </div>
        <div id="wordMsg" class="small"></div>
        <div style="margin-top:8px;">
          <button id="toChoose" class="muted">â­ï¸ Ù…Ø±Ø­Ù„Ù‡Ù” ØªØ´Ø®ÛŒØµ</button>
        </div>
      </div>

      <div id="chooseArea" class="hidden" style="margin-top:12px;">
        <h3>Ù…Ø±Ø­Ù„Ù‡ Û´: Ø´Ù†ÛŒØ¯Ø§Ø±ÛŒ + ØªØµÙˆÛŒØ±ÛŒ</h3>
        <div style="margin-bottom:8px;">
          <button id="playTarget" class="muted">ğŸ”Š Ù¾Ø®Ø´ Ú©Ù„Ù…Ù‡ Ù‡Ø¯Ù</button>
        </div>
        <div class="choices">
          <div class="choice" data-word="Ø¨Ø§Ø¨Ø§">ğŸ‘¨</div>
          <div class="choice" data-word="Ø³ÛŒØ¨">ğŸ</div>
          <div class="choice" data-word="ØªÙˆÙ¾">âš½</div>
        </div>
        <div id="chooseMsg" class="small"></div>
      </div>

      <div id="score" class="star"></div>
      <div class="small">Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ± Ø§Ø² Google Chrome Ø¯Ø± Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ø¨Ù‡ Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ù‡ÛŒØ¯.</div>
    </div>

    <footer>Ù†Ø³Ø®Ù‡Ù” ØªØ³Øª â€” Ø§Ú¯Ø± Ù…Ø´Ú©Ù„ÛŒ Ø´Ø¯ÛŒØ¯ Ø¨ÙˆØ¯ Ø®Ø¨Ø± Ø¨Ø¯Ù‡ ØªØ§ Ø§ØµÙ„Ø§Ø­ Ú©Ù†Ù….</footer>
  </div>

<script>
/* ======== Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ======== */
const lesson = {
  letter: "Ø¨",
  syllables: ["Ø¨Ø§","Ø¨Ùˆ","Ø¨ÛŒ"],
  word: "Ø¨Ø§Ø¨Ø§",
  choices: [
    {word:"Ø¨Ø§Ø¨Ø§", emoji:"ğŸ‘¨"},
    {word:"Ø³ÛŒØ¨", emoji:"ğŸ"},
    {word:"ØªÙˆÙ¾", emoji:"âš½"}
  ]
};

let score = 0;
let currentSyll = lesson.syllables[0];

/* ======== Ø§Ù„Ù…Ù†Øªâ€ŒÙ‡Ø§ ======== */
const bigChar = document.getElementById('bigChar');
const playLetter = document.getElementById('playLetter');
const listenLetter = document.getElementById('listenLetter');
const nextToVowels = document.getElementById('nextToVowels');
const message = document.getElementById('message');

const vowelsArea = document.getElementById('vowelsArea');
const vowelBtns = document.querySelectorAll('.vowelBtn');
const playSyll = document.getElementById('playSyll');
const listenSyll = document.getElementById('listenSyll');
const subMessage = document.getElementById('subMessage');
const toWord = document.getElementById('toWord');

const wordArea = document.getElementById('wordArea');
const playWord = document.getElementById('playWord');
const listenWord = document.getElementById('listenWord');
const wordMsg = document.getElementById('wordMsg');
const toChoose = document.getElementById('toChoose');

const chooseArea = document.getElementById('chooseArea');
const playTarget = document.getElementById('playTarget');
const choices = document.querySelectorAll('.choice');
const chooseMsg = document.getElementById('chooseMsg');

const scoreEl = document.getElementById('score');

/* ======== Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ ======== */
function normalizePersian(s){
  if(!s) return "";
  s = s + "";
  s = s.toLowerCase().trim();
  s = s.replace(/[\u064B-\u0652]/g, "");
  s = s.replace(/[ÙŠ]/g,"ÛŒ").replace(/[Ùƒ]/g,"Ú©");
  s = s.replace(/Ø¢/g,"Ø§");
  s = s.replace(/\s+/g,"");
  return s;
}

/* ======== Text-to-Speech ======== */
function speak(text, onend){
  if(!('speechSynthesis' in window)){
    alert('Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ù¾Ø®Ø´ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
    if(onend) onend();
    return;
  }
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'fa-IR';
  u.rate = 0.95;
  u.onend = ()=>{ if(onend) onend(); };
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

/* ======== Speech Recognition wrapper ======== */
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition || null;
function isRecognitionAvailable(){ return !!SpeechRecognition; }

function listenOnce(lang='fa-IR', timeout=7000){
  return new Promise((resolve,reject)=>{
    if(!SpeechRecognition){
      reject('noapi');
      return;
    }
    let r = new SpeechRecognition();
    r.lang = lang;
    r.interimResults = false;
    r.maxAlternatives = 3;
    try{
      r.start();
    }catch(e){
      reject(e);
      return;
    }
    let done = false;
    r.onresult = (ev)=>{
      done = true;
      const txt = ev.results[0][0].transcript;
      resolve(txt);
    };
    r.onerror = (ev)=>{
      if(!done) reject(ev.error || ev.message || 'error');
    };
    // safety stop
    setTimeout(()=>{ try{ r.stop(); }catch(e){} }, timeout);
  });
}

/* ======== Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡) ======== */
async function ensureMic(){
  if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) return;
  try{
    await navigator.mediaDevices.getUserMedia({ audio: true });
  }catch(e){
    // Ú©Ø§Ø±Ø¨Ø± Ø§Ø¬Ø§Ø²Ù‡ Ù†Ø¯Ø§Ø¯ ÛŒØ§ Ø®Ø·Ø§
    console.log('mic permission denied or error', e);
  }
}

/* ======== Ù…Ø±Ø­Ù„Ù‡ 1: Ø­Ø±Ù ======== */
bigChar.textContent = lesson.letter;
playLetter.addEventListener('click', ()=> speak(lesson.letter));
listenLetter.addEventListener('click', async ()=>{
  message.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ Ø­Ø±Ù Ø±Ø§ Ø¨Ú¯Ùˆ.";
  if(!isRecognitionAvailable()){ message.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯."; return; }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    message.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(lesson.letter);
    if(got === target || got.includes(target)){
      message.textContent = "Ø¢ÙØ±ÛŒÙ†! ØªÙ„ÙØ¸ Ø­Ø±Ù Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ ğŸ‰";
      score++; updateScore();
      // Ù†Ù…Ø§ÛŒØ´ Ø¯Ú©Ù…Ù‡ Ø§Ø¯Ø§Ù…Ù‡
      nextToVowels.classList.remove('muted'); nextToVowels.disabled = false;
      // Ø§Ù†Ø¯Ú©ÛŒ Ø¨Ø¹Ø¯ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯
      setTimeout(()=> showVowels(), 900);
    } else {
      message.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ Ø¯Ú©Ù…Ù‡ Ù¾Ø®Ø´ Ø±Ø§ ÙØ´Ø§Ø± Ø¨Ø¯Ù‡.";
    }
  }catch(err){
    if(err === 'noapi') message.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else message.textContent = "Ø®Ø·Ø§ Ø¯Ø± ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±: " + (err.message || err);
  }
});
nextToVowels.addEventListener('click', showVowels);

/* ======== Ù†Ù…Ø§ÛŒØ´ Ùˆ Ú©Ø§Ø± Ø¨Ø§ Ø­Ø±Ú©Ø§Øª ======== */
function showVowels(){
  vowelsArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û²: Ø­Ø±Ú©Ø§Øª (Ø¨Ø§ØŒ Ø¨ÙˆØŒ Ø¨ÛŒ)";
  // Ø§Ù†ØªØ®Ø§Ø¨ Ø§ÙˆÙ„ÛŒÙ†
  currentSyll = lesson.syllables[0];
  highlightSyll(currentSyll);
  speak(currentSyll);
}

function highlightSyll(s){
  vowelBtns.forEach(b=>{
    if(b.dataset.syll === s) b.style.borderColor = '#2196f3';
    else b.style.borderColor = '#eee';
  });
}
vowelBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const s = btn.dataset.syll;
    currentSyll = s;
    highlightSyll(s);
    speak(s);
    subMessage.textContent = "";
  });
});
playSyll.addEventListener('click', ()=> { speak(currentSyll); });
listenSyll.addEventListener('click', async ()=>{
  subMessage.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ ØªÚ©Ø±Ø§Ø± Ú©Ù†.";
  if(!isRecognitionAvailable()){ subMessage.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯."; return; }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    subMessage.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(currentSyll);
    if(got === target || got.includes(target)){
      subMessage.textContent = "Ø¢ÙØ±ÛŒÙ†! Ø¯Ø±Ø³Øª Ú¯ÙØªÛŒ ğŸ‰";
      score++; updateScore();
      // Ø¨Ø±Ùˆ Ù…Ø±Ø­Ù„Ù‡Ù” Ø¨Ø¹Ø¯ Ø§Ú¯Ø± Ø¢Ø®Ø± Ø¨ÙˆØ¯
      let idx = lesson.syllables.indexOf(currentSyll);
      if(idx < lesson.syllables.length - 1){
        currentSyll = lesson.syllables[idx+1];
        highlightSyll(currentSyll);
        setTimeout(()=> speak(currentSyll), 700);
      } else {
        // Ù‡Ù…Ù‡ Ø­Ø±Ú©Øªâ€ŒÙ‡Ø§ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ø› Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ù„Ù…Ù‡
        setTimeout(()=> showWord(), 900);
      }
    } else {
      subMessage.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ ØµØ¯Ø§ Ø±Ø§ Ú¯ÙˆØ´ Ú©Ù†.";
    }
  }catch(err){
    if(err === 'noapi') subMessage.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else subMessage.textContent = "Ø®Ø·Ø§ Ø¯Ø± ØªØ´Ø®ÛŒØµ Ø³Ø®Ù†: " + (err.message || err);
  }
});
toWord.addEventListener('click', showWord);

/* ======== Ù…Ø±Ø­Ù„Ù‡ 3: Ú©Ù„Ù…Ù‡ ======== */
function showWord(){
  wordArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û³: Ú©Ù„Ù…Ù‡";
  speak(lesson.word);
}
playWord.addEventListener('click', ()=> speak(lesson.word));
listenWord.addEventListener('click', async ()=>{
  wordMsg.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ú©Ø±Ø¯Ù†... Ù„Ø·ÙØ§Ù‹ Ú©Ù„Ù…Ù‡ Ø±Ø§ Ø¨Ú¯Ùˆ.";
  if(!isRecognitionAvailable()){ wordMsg.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯."; return; }
  try{
    await ensureMic();
    const t = await listenOnce('fa-IR');
    wordMsg.textContent = "Ø´Ù…Ø§ Ú¯ÙØªÛŒØ¯: " + t;
    const got = normalizePersian(t);
    const target = normalizePersian(lesson.word);
    if(got === target || got.includes(target)){
      wordMsg.textContent = "Ø¢ÙØ±ÛŒÙ†! ØªÙ„ÙØ¸ Ú©Ù„Ù…Ù‡ Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ ğŸ‰";
      score++; updateScore();
      setTimeout(()=> showChoose(), 900);
    } else {
      wordMsg.textContent = "Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù† ÛŒØ§ ØµØ¯Ø§ Ø±Ø§ Ú¯ÙˆØ´ Ú©Ù†.";
    }
  }catch(err){
    if(err === 'noapi') wordMsg.textContent = "Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² SpeechRecognition Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.";
    else wordMsg.textContent = "Ø®Ø·Ø§: " + (err.message || err);
  }
});
toChoose.addEventListener('click', showChoose);

/* ======== Ù…Ø±Ø­Ù„Ù‡ 4: Ù¾Ø®Ø´ Ú©Ù„Ù…Ù‡ Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ± ======== */
function showChoose(){
  chooseArea.classList.remove('hidden');
  document.getElementById('stageTitle').textContent = "Ù…Ø±Ø­Ù„Ù‡ Û´: Ø´Ù†ÛŒØ¯Ø§Ø±ÛŒ + ØªØµÙˆÛŒØ±ÛŒ (Ù„Ù…Ø³ ØªØµÙˆÛŒØ± Ø¯Ø±Ø³Øª)";
  // shuffle choices visually (but keep map)
  // we simply leave as-is for test
  speak(lesson.word);
}
playTarget.addEventListener('click', ()=> speak(lesson.word));
choices.forEach(ch=>{
  ch.addEventListener('click', ()=>{
    const pick = ch.dataset.word;
    if(normalizePersian(pick) === normalizePersian(lesson.word)){
      ch.classList.add('correct');
      chooseMsg.textContent = "Ø¢ÙØ±ÛŒÙ†! Ø¯Ø±Ø³Øª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯ÛŒ ğŸ‰";
      score++; updateScore();
      // Ù†ÙˆØ¨Øª ØªÙ…ÙˆÙ… Ø´Ø¯ â€” Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø±ÛŒØ³Øª Ú©Ù†ÛŒÙ… ÛŒØ§ Ù¾ÛŒØ§Ù… Ù¾Ø§ÛŒØ§Ù† Ø¨Ø¯Ù‡ÛŒÙ…
      setTimeout(()=> {
        chooseMsg.textContent = "ØªØ¨Ø±ÛŒÚ©! ØªÙ…Ø±ÛŒÙ† Ø§ÛŒÙ† Ø¯Ø±Ø³ ØªÙ…Ø§Ù… Ø´Ø¯.";
      },700);
    } else {
      ch.classList.add('wrong');
      chooseMsg.textContent = "Ù†Ù‡Ø› Ø§Ø´ØªØ¨Ø§Ù‡Ù‡. Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.";
      setTimeout(()=> { ch.classList.remove('wrong'); chooseMsg.textContent=''; },900);
    }
  });
});

/* ======== helper: update score ======== */
function updateScore(){
  scoreEl.textContent = "â­".repeat(score);
}

/* ======== Ø§Ú¯Ø± ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†Ø¨Ø§Ø´Ø¯ ======== */
if(!isRecognitionAvailable()){
  const warn = document.createElement('div');
  warn.className='small';
  warn.style.color='crimson';
  warn.style.marginTop='8px';
  warn.textContent = 'ØªØ°Ú©Ø±: Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯Ø› Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ú©Ø§Ø±Ù Ù¾Ø®Ø´ ØµØ¯Ø§ ÙØ¹Ø§Ù„ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯ Ø§Ù…Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ú¯ÙØªØ§Ø± ØºÛŒØ± Ù…Ù…Ú©Ù† Ø§Ø³Øª.';
  document.querySelector('.card').appendChild(warn);
}

/* ======== Ø´Ø±ÙˆØ¹ Ø§ÙˆÙ„ÛŒÙ‡: Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø®Ø§Ù…ÙˆØ´ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯Ù†later ======== */
(async ()=>{ await ensureMic(); })();

</script>
</body>
</html>